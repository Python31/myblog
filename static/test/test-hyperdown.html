<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Marked in the browser</title>
    <link rel="stylesheet" href="../../node_modules/highlight.js/styles/googlecode.css">
    <script src="../../node_modules/marked/marked.min.js"></script>
    <script src="../../node_modules/highlight.js/lib/highlight.js"></script>
    <script src="../../node_modules/jQuery/tmp/jquery.js"></script>
    <style>
        table td,th{
            border:1px solid #ddd;
        }
    </style>
</head>
<body>
<div id="content"></div>

<script>

    marked.setOptions({
        renderer: new marked.Renderer(),
        gfm: true,
        tables: true,
        breaks: false,
        pedantic: false,
        sanitize: false,
        smartLists: true,
        smartypants: false
    });
    var md = getElementById('md').innerHTML;
    document.getElementById('content').innerHTML =
        marked(md);

    var xmlHttp;
    function createxmlHttpRequest() {
        if (window.ActiveXObject) {
            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
        } else if (window.XMLHttpRequest) {
            xmlHttp = new XMLHttpRequest();
        }
    }
    function doGet(url){
// 注意在传参数值的时候最好使用encodeURI处理一下，以防出现乱码
        createxmlHttpRequest();
        xmlHttp.open("GET",url);
        xmlHttp.send(null);
        xmlHttp.onreadystatechange = function(RES) {
            if ((xmlHttp.readyState == 4) && (xmlHttp.status == 200)) {
                console.log(RES.currentTarget.responseText);
                document.getElementById('content').innerHTML =
                    marked(RES.currentTarget.responseText);
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });
            } else {
                console.log('fail');
            }
        }
    }
    doGet("../data/1.md");
    /*$.ajax({
        url:"../data/1.md",
        method:"get",
        success:function(res){
            hljs.initHighlightingOnLoad();
            marked.setOptions({
                renderer: new marked.Renderer(),
                gfm: true,
                tables: true,
                breaks: false,
                pedantic: false,
                sanitize: false,
                smartLists: true,
                smartypants: false
            });
            document.getElementById('content').innerHTML =
                marked(res);
            hljs.highlightBlock();
        }
    })*/
</script>
</body>
</html>
