
## 思考题：因为 NoSQL 的方案功能都很强大，有人认为 NoSQL = No SQL，架构设计的时候无需再使用关系数据库，对此你怎么看？

我认识不是这个的，因为NoSQL只是对SQL的一种补充，因为SQL并不能实用所有的场景，比如
- 大数据的情况下列式数据库比较常用
- 在常用搜索的情况下，全文搜索比较好用
- 如果对schema要求不强烈的情况下，用文档数据库比较好


SQL只是适用于大多数的场景。虽然有的时候效率比较低。

NoSQL在ACID上没有办法和SQL相比
##  总结

### 1. K-V存储

代表：Redis

典型操作：
- LPOP key 从队列的左边出队一个元素。
- LINDEX key index 获取一个元素，通过其索引列表。
- LLEN key 获得队列（List）的长度。
- RPOP key 从队列的右边出队一个元素。

以上的功能通过关系型数据库来实现的话会比较麻烦。因为关系型数据量是没有位置编号的，还要增加记录位置的字段

缺点是不支持完整的ACID：
- 事务性比关系型数据库差太远
- Redis 的事务只能保证隔离性和一致性（I 和 C），无法保证原子性和持久性（A 和 D）

### 2. 文档数据量

代表： MongoDB

优势：
- 新增字段简单
- 历史数据不会出错
    + 对于历史数据，即使没有新增的字段，也不会导致错误，只会返回空值，此时代码进行兼容处理即可。
- 可以很容易存储复杂数据
    + 反正也是json，随你怎么处理

缺点：
- 事务性支持差
- 不支持join

### 3. 列式数据库

代表：HBase

优势：
- I/O效率：关系型数据库如果统计单列的话，会把一行中都搞出来
- 存储效率：普通的行式数据库一般压缩率在 3:1 到 5:1 左右，而列式数据库的压缩率一般在 8:1 到 30:1 左右
    + 因为单个列的数据相似度相比行来说更高，能够达到更高的压缩率。
- 一般将列式存储应用在离线的大数据分析和统计场景中，因为这种场景主要是针对部分列单列进行操作，且数据写入后就无须再更新删除

列势：
- 频繁更新多个列
    + 列式存储将不同列存储在磁盘上不连续的空间，导致更新多个列时磁盘是随机写操作
    + 行式存储时同一行多个列都存储在连续的空间，一次磁盘写操作就可以完成
    + 列式存储的随机写效率要远远低于行式存储的写效率
    + 列式存储高压缩率在更新场景下也会成为劣势，因为更新时需要将存储数据解压后更新，然后再压缩，最后写入磁盘。


### 4. 全文搜索引擎

代表： ES

关系型数据库的不足：
- 全文搜索的条件可以随意排列组合，如果通过索引来满足，则索引的数量会非常多。
- 全文搜索的模糊匹配方式，索引无法满足，只能用 like 查询，而 like 查询是整表扫描，效率非常低。






